# 로컬 개발용
# 가장 간단한 형태로 웹 컨테이너 하나만 띄워서 SQLite 그대로 쓰게 해보기
# 나중에 DB를 Postgres로 바꾸고(진행중), Prometheus/Grafana 추가는 다음 단계

version: "3.9"

services:
  db:
    image: postgres:15
    restart: unless-stopped
    environment:
      POSTGRES_DB: jacommi
      POSTGRES_USER: jacommi
      POSTGRES_PASSWORD: jacommi-password
    volumes:
      - pgdata:/var/lib/postgresql/data

  web:
    build: .
    container_name: jacommi-web
    ports:
      - "8001:8000"
    env_file:
      - .env.docker
    environment:
      DJANGO_DEBUG: "False"
    restart: unless-stopped
    # 개발 중 코드 실시간 반영이 필요하면 주석 해제
    volumes:
      - ./firebase.json:/app/firebase.json

volumes:
  pgdata:
    driver: local
  # static_volume:
  #   driver: local